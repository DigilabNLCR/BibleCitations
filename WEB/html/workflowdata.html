    <div class="header">
        <div class="header-content-box">
            <div class="header-text-content">
                <h1 class="h1-header">Workflow & data</h1>
                <p class="p-header">Na tomto místě se můžete seznámit s postupem, který jsme vyvinuli jako návrh možného řešení detekce biblických citací (nejen) v prvorepublikovém tisku. Zde poskytnutý popis se snaží co možná nejvíce problematiku přiblížit, aniž by se zbytečně zabíhalo do příliš technického popisu.</p>
                <p class="p-header">Kompletní script a řešení je možné nalézt na portálu <a href="https://github.com/DigilabNLCR/BibleCitations">GitHub</a></p>
            </div>
            <a href="https://github.com/DigilabNLCR/BibleCitations" class="header-image-link"><img src="images/Octocat.png" alt="GitHub Octocat" class="header-image-link"><img src="images/GitHub_Logo.png" alt="GitHub Octocat" class="header-image-link"></a>
        </div>
    </div>

    <div class="content-window-white">
        <div class="content-inner-box">
            <div class="content-text">
                <h2 id="PeriodikaDataset">Periodika</h2>
                <p>Jak již bylo zmíněno na <a href="./index.php">úvodní stránce projektu</a>, náš projekt je zaměřen na prvorepublikový tisk v letech 1925 až 1939. Konkrétní periodika byla zvolena tak, aby obsahovala pestřejší škálu témat, u kterých lze očekávat rozdílné výsledky detekování biblických citací. Omezený časový výsek, stejně jako zvolená periodika jsou ale také odrazem dostupnosti dat a jejich vzájemného časového překryvu. Důležité je upozornit zejména na dostupnost některých periodik v konkrétních letech – katolicky laděný <i>Čech</i> nám byl dostupný pouze v letech 1925 až 1935, ačkoliv vycházel až do roku 1937. <i>Polední list</i> jsme v době tvorby projektu měli k dispozici dokonce pouze v letech 1930 až 1933.</p>
                <ul>
                    <li><a href="https://www.ndk.cz/periodical/uuid:5c259210-2182-11e6-918e-5ef3fc9ae867"><i>Čech: politický týdeník katolický</i></a> byly katolicky laděné noviny vycházející v denní periodicitě od roku 1869 (v letech 1897 až 1903 pod názvem <i>Katolické listy</i>) jako reprezentant nejstarší politické strany v českých zemích, Národní strany staročeské.</li>
                    <li><a href="https://ndk.cz/periodical/uuid:945558f0-4da6-11e6-8361-5ef3fc9ae867"><i>Věstník katolického duchovenstva</i></a> byl měsíčníkem vycházejím mezi lety 1900–1942, přičemž v letech 1900–1920 byl vydáván dvakrát měsíčně. Jak naznačují i podtituly, které tento věstník nesl, <i>církevně-politický a zájmový orgán katolického kléru v zemích Koruny české, respektive církevně-politický a zájmový orgán katol. klerů v státě československém</i>, ve velké míře se zabýval katolickými tématy.</li>
                    <li><a href="https://ndk.cz/periodical/uuid:c9efda4e-a4ba-4406-b59a-98b8ad162b49"><i>Moravský hospodář</i></a> navázal na <i>Ústřední list rolnictva moravského</i>. Začal vycházet roku 1898, a přestal v roce 1941. Toto periodikum vycházející jednou za 14 dní se zaměřovalo na zemědělství a ekonomiku.</li>
                    <li><a href="https://www.ndk.cz/periodical/uuid:df98905c-a994-4804-afce-d19792d9c22d"><i>Moravský večerník</i></a> vycházel v Olomouci v letech 1922–1945 v různé periodicitě, ve sledovaném období jako deník. Obsahem jednotlivých čísel byla jak politika, tak rovněž krátké zprávy z regionu, kulturní tipy, sportovní zpravodajství nebo reklamy.</li>
                    <li><a href="https://ndk.cz/periodical/uuid:68cd2c50-e40b-11e8-bc37-005056827e51"><i>Přítomnost: nezávislý týdeník</i></a> byla vydávána mezi lety 1924–1939 a 1942–1945.  Ve 30. letech byla jedním z nejuznávanějších deníků zabývajících se politikou.</li>
                    <li><a href="https://www.ndk.cz/periodical/uuid:e75c0530-19fc-11e7-981b-005056825209"><i>Venkov: orgán České strany agrární</i></a>, od roku 1916 byl ústřední list <i>České strany agrární</i> ústředním tiskovým orgánem agrární strany a byl vydáván v letech 1906–1938.</li>
                    <li><a href="https://ndk.cz/periodical/uuid:98006af7-9835-4d9c-99e1-e0be29b4a037"><i>Studentský časopis</i></a> začal být vydáván v roce 1922 a ukončen 1942. Jednalo se o časopis určený pro mládež, čemuž byly i přizpůsobeny texty. Ve sledovaném období byl vydáván desetkrát do roka.</li>
                    <li><a href="https://ndk.cz/periodical/uuid:babfdbe0-5f48-11e8-a67a-5ef3fc9ae867"><i>Československý zemědělec</i></a> byl vydáván mezi lety 1919 a 1939, a to v týdenní periodicitě. V rámci tohoto periodika pravidelně vycházelo několik příloh, které se zabývaly zemědělstvím a hospodářstvím v tom nejširším slova smyslu.</li>
                    <li><a href="https://ndk.cz/periodical/uuid:6a7a0500-060a-11e6-a5b6-005056827e52"><i>Český učitel: věstník Zemského ústředního spolku jednot učitelských v Čechách</i></a> začal vycházet v roce 1897 jako týdeník (kromě prázdnin), v době trvání první světové války bylo vydávání přerušeno a opět obnoveno v roce 1919. K zániku tohoto týdeníku došlo v roce 1941. Zaměřoval se především na témata související se vzděláváním a výukou.</li>
                    <li><a href="https://www.ndk.cz/periodical/uuid:fe61f250-7553-11ec-b436-5ef3fc9bb22f"><i>Posel záhrobní: spiritistický časopis věnovaný záhadám duševním</i></a> byl předním časopisem českých spiritistů, spojený s osobou Karla Sezemského. Byl vydáván čtyřikrát do roka mezi lety 1900–1940 a obsahoval nejen překlady ze zahraničních časopisů, medijní projevy, ale oznamoval také místa konání spiritistických přednášek a sjezdů.</li>
                    <li><a href="https://www.ndk.cz/periodical/uuid:62722340-2d7f-11e2-a8e5-005056827e52"><i>Polední list</i></a> byl nepolitickým časopisem vydávaným v novinářském koncernu Tempo mezi lety 1929–1945 v denní periodicitě.</li>
                </ul>
                <p>Níže můžete vidět graf, který podává celkový přehled o rozsahu prozkoumávaného datasetu.</p>
            </div>
            <div class="flourish-embed flourish-chart" data-src="visualisation/11096072"><script src="https://public.flourish.studio/resources/embed.js"></script></div>
        </div>
    </div>

    <div class="content-window-grey">
        <div class="content-inner-box">
            <div class="content-text">
                <h2 id="BibleDataset">Bible</h2>
                <p>Charakter nám dostupného biblického datasetu výrazně ovlivňuje možnosti, které máme pro detekci jednotlivých veršů napříč prohledávaným korpusem, viz <a href="#anchorBibleProblems">níže</a>. Ze serveru <a href="https://obohu.cz/">obohu.cz</a> nám byly poskytnuty čtyři překlady – konkrétně <a href="https://obohu.cz/bible/index.php?k=Gn&kap=1&styl=BKR">Bible kralická</a> (Starý a Nový zákon), překlad <a href="https://obohu.cz/bible/index.php?styl=HEJCL&k=Gn&kap=1">Jana Hejčla</a> (Starý zákon a Deuterokanonické knihy), překlad <a href="https://obohu.cz/bible/index.php?k=Mt&kap=1&styl=SYK">Jana Ladislava Sýkory</a> (Nový zákon) a překlad <a href="https://obohu.cz/bible/index.php?styl=ZP&k=Mt&kap=1">Františka Žilky</a> (Nový zákon). Navíc nám byly <a href="https://www.muni.cz/lide/4755-pavel-kosek">Pavlem Koskem z Masarykovy univerzity</a> poskytnuty některé části tzv. Bible svatováclavské. Na následujícím grafu můžete vidět přehledovou statistiku rozsahu biblického datasetu.</p>
            </div>
            <div class="flourish-embed flourish-chart" data-src="visualisation/11090686"><script src="https://public.flourish.studio/resources/embed.js"></script></div>
        </div>
    </div>

    <div class="content-window-white">
        <div class="content-inner-box">
            <div class="content-text">
                <p></p>
                <h2>Problematika dat</h2>
                <p>Najít v jakémkoliv textu biblický verš se může zdát jako poměrně jednoduchá a přímočará záležitost. Celý proces nicméně naráží na mnoho komplikací, které plynou jak z povahy biblického textu, tak z povahy textů, ve kterých citace hledáme. Níže shrnujeme nejpodstatnější překážky, které vylučují jednoduché fulltextové vyhledávání.</p>
                <h3 id="anchorBibleProblems">Problematika biblického textu</h3>
                <p>Bible je v českém jazyce  dostupná v mnoha překladech. Situace ve 30. letech minulého století nebyla jiná, a i v této době se paralelně používalo více překladů. Jak je vidět <a href="#BibleDataset">výše</a>, dostupnost používaných překladů je bohužel značně omezená a nemalá část z nich stále podléhá autorskému zákonu. Ve zkoumaných textech se navíc nezřídka objevují různé parafráze či aluze (narážky), které mohou mnohdy být považovány za biblický citát, avšak neodpovídají žádnému z nám dostupných překladů. Například známá část verše Mt 22:37 „<i>Milovati budeš Pána Boha svého z celého srdce svého, a ze vší duše své, a ze vší mysli své.</i>“ byla nalezena i ve spojení „<i>Milovati budeš Pána Boha svého … nade všecko“</i>.</p>
                <p>Biblické verše jsou navíc nezřídka citovány jen zčásti. To vede k nutnosti verše rozdělovat na menší části, které v rámci tohoto projektu nazýváme podverše. Automatizované dělení na menší části s sebou nicméně přináší další komplikace, jelikož takovéto dělení ne vždy vede ke smysluplnému úryvku z verše. Může tak docházet ke zkreslení výsledků.</p>
                <p>Další obtíže způsobují verše a podverše, které jsou příliš obecné povahy, a i když se třeba plně vyskytují v prohledávaném textu, o biblické citáty se nejedná. Tento problém je řešen pomocí předem připraveného seznamu takovýchto veršů a podveršů, které ve výsledném čištění dat ignorujeme. To do zpracování nicméně vnáší nutnou ruční práci vědce, která nemusí být vždy stoprocentní (odpovídající verše byly vytipovány až na základě prohledávání), navíc některé obecné verše se mohou ukázat jako skutečné biblické citáty. Jako příklad může sloužit verš Ex 20:13, tedy přikázání „<i>Nezabiješ</i>“. Zdali je nalezená citace skutečně biblickým citátem, či nikoliv, je rozpoznatelné až dle kontextu. Detekce na takovéto úrovni by vyžadovala jiný, významně <a href="#anchorImprovements">složitější přístup</a>.</p>
                <p>Posledním úskalím, které zde zmíníme, je vnitřní intertextualita Bible. Některá znění veršů a podveršů se objevují v Bibli na více místech, a není tak vždy jednoznačné, kterému verši je nalezenou citaci vhodné připsat. Příkladem tohoto fenoménu může být proslulý idiom „<i>hlas volajícího na poušti</i>“, který nalezneme na několika místech Bible (evangelia Mt 3:3, J 1:23 a Mk 1:3 v tomto odkazují na Iz 40:3).</p>
                <h3 id="anchorJournalsProblems">Problematika periodik</h3>
                <p>Problematický avšak není pouze biblický text. Také periodika, ve kterých verše hledáme, mají své nedostatky. Tím prvním je samotná dostupnost, která limituje náš výběr. Druhým a nejzásadnějším problémem je pak kvalita OCR. Tato překážka v některých případech naprosto znemožňuje práci s daty, avšak ve většině případů je naštěstí kvalita OCR dostatečná, aby bylo možné s určitou tolerancí citáty detekovat.</p>
            </div>
            <pre>
                <code class="language-python">
    """ Ukázka naprosto špatně rozpoznaného textu. """
    bad_ocr_example = ':1$yé^7nisn^rátu>" .tam\'.^hilcòlnr\' v\'mmt^ferjèh^Vojenskí; ^viětíek, pochybu je, д^е Iry pbíipsl tra ^гогкаг!е vlc/zastřelení j rukojmí řgeUibferai Rozkaž\'byl tak‘e|z!r»ičeň, ^zaie^oyalo •*Se jen usnesení\' 1.; jptíníU, žiSající i zaStřek: ní rukojmí, к nětmuž^Eglhofer .poznamenal: „Jsem; srbz(Шпеп.'

    """ Ukázka nedokonale rozpoznaného textu, který obsahuje biblický citát. """
    poor_ocr_with_bible_quote = '„Mrlovati budeš bližního svého jako sebe samého“, je teprve druhé ze dvou přikázání lásky, podobné prvému :„Мдlovati budeš Pána Boha svého ... nade všecko.“ Proč dnešní láska blíženecká je namnoze tak neplodná, pouhá slova?'
                </code>
            </pre>
        </div>
    </div>

    <div class="content-window-grey">
        <div class="content-inner-box">
            <div class="content-text">
                <h2>Postup</h2>
                <p>Abychom překonali výše zmíněné limity, hledání jsme rozdělili do několika kroků. Níže je popsán proces prohledávání na jednom konkrétním případě. Pro detailní postup včetně kódu se můžete podívat na <a href="https://github.com/DigilabNLCR/BibleCitations">GitHub</a> projektu, zejména na <a href="https://github.com/DigilabNLCR/BibleCitations/blob/main/biblical_intertextuality_notebook.ipynb">Jupyter Notebook</a> popisující proces prohledávání. Celý projekt je vystavěn v <a href="https://www.python.org/downloads/release/python-399/">Python v. 3.9.9</a> za použití externích balíčků.</p>
            </div>
            <pre>
                <code class="language-python" id="anchorPythonPackages">
    import pandas as pd
    import os
    import joblib

    from os import listdir as os_listdir
    from os.path import isdir as os_path_isdir
    from os.path import exists as os_exists
    from os import remove as os_remove
    from json import load as json_load
    from re import sub as re_sub
    from re import split as re_split
    from os.path import join as join_path
    from unidecode import unidecode
    from time import time
    from Levenshtein import distance
    from gensim import corpora
    from collections import defaultdict
    from nltk import word_tokenize, sent_tokenize
    from math import ceil, isnan
                </code>
            </pre>
        </div>
    </div>

    <div class="content-window-white">
        <div class="content-inner-box">
            <div class="content-text">
                <h3>Příprava biblického datasetu</h3>
                <p>Prvním krokem je vytvoření biblického datasetu, který pak umožní prohledávání na libovolných datech. Biblický dataset obsahuje všechny verše ve všech nám <a href="#BibleDataset">dostupných překladech</a>. Vytvoření datasetu je níže ilustrováno na příkladu verše Mk 12:17 v překladu <a href="https://obohu.cz/bible/index.php?styl=SYK&kap=12&k=Mk">Ladislava Sýkory</a>:</p>
                <p style="text-align: center; padding: 15px; font-size: 20px;">„<i>Ježíš pak řekl jim: „Dávejte tedy, co je císařovo, císaři; a co je Božího, Bohu!“ I divili se mu.</i>“</p>
                <p>Každý verš je nejprve rozdělen na podverše:</p>
            </div>
            <pre>
                <code class="language-python">
    verse_text = 'Ježíš pak řekl jim: ,Dávejte tedy, co jest císařovo, císaři, a co jest Božího, Bohu.“ I divili se mu.'
    subverses = ['Ježíš pak řekl jim Dávejte tedy',
            'Dávejte tedy co jest císařovo',
            'co jest císařovo císaři',
            'císaři a co jest Božího',
            'a co jest Božího Bohu.“ I divili se mu.',
            'Bohu.“ I divili se mu.']
                </code>
            </pre>
            <div class="content-text">
                <p>Každý z těchto podveršů je následně rozdělen na n-gramy o velikosti maximálně čtyř znaků. Volba právě čtyř znaků byla výsledkem mnoha experimentů. Toto rozdělení podverše na menší části předchází výše zmíněným problémům s OCR. Můžete si všimnout, že některá slova jsou označena jako tzv. stop-words, tedy slova, která ve vyhledávání ignorujeme. V tomto případě se jedná například o „<i>a</i>“, „<i>i</i>“ nebo „<i>se</i>“.</p>
            </div>
            <pre>
                <code class="language-python">
    subverse_1 = ['jezi', 'ezis', 'rekl', 'jim', 'dave', 'avej', 'vejt', 'ejte', 'tedy']
    subverse_2 = ['dave', 'avej', 'vejt', 'ejte', 'tedy', 'co', 'jest', 'cisa', 'isar', 'saro', 'arov', 'rovo'] 
    subverse_3 = ['co', 'jest', 'cisa', 'isar', 'saro', 'arov', 'rovo', 'cisa', 'isar', 'sari']
    subverse_4 = ['cisa', 'isar', 'sari', 'co', 'jest', 'bozi', 'ozih', 'ziho'] 
    subverse_5 = ['co', 'jest', 'bozi', 'ozih', 'ziho', 'bohu', 'divi', 'ivil', 'vili', 'mu'] 
    subverse_6 = ['bohu', 'divi', 'ivil', 'vili', 'mu']
                </code>
            </pre>
            <div class="content-text">
                <p>N-gramovaný verš je následně převeden na vektor, který zaznamenává počet výskytů jednotlivých n-gramů v podverši. N-gramy jsou tedy nahrazeny čísly a postupně vzniká slovník, který zachovává přiřazení n-gramů k jednotlivým číslům. Pro tyto účely byl využit Python balíček <a href="https://radimrehurek.com/gensim/">gensim</a>.</p>
            </div>
            <pre>
                <code class="language-python">
    subverse_1 = ((10, 1), (11, 1), (12, 1), (13, 1), (14, 1), (21, 1), (22, 1), (23, 1), (24, 1))
    subverse_2 = ((0, 1), (1, 1), (10, 1), (11, 1), (12, 1), (13, 1), (14, 1), (15, 1), (16, 1), (17, 1), (18, 1), (19, 1))
    subverse_3 = ((0, 1), (1, 1), (15, 2), (16, 2), (17, 1), (18, 1), (19, 1), (20, 1))
    subverse_4 = ((0, 1), (1, 1), (2, 1), (3, 1), (4, 1), (15, 1), (16, 1), (20, 1))
    subverse_5 = ([(0, 1), (1, 1), (2, 1), (3, 1), (4, 1), (5, 1), (6, 1), (7, 1), (8, 1), (9, 1))
    subverse_6 = ((5, 1), (6, 1), (7, 1), (8, 1), (9, 1))
                </code>
            </pre>
            <div class="content-text">
                <p>Uvedeným postupem je vytvořen kompletní dataset, který zachovává přiřazení označení verše (např. Mk 12:17) ke všem vektorům, které odpovídají jednotlivým podveršům napříč překlady.</p>
            </div>
        </div>
    </div>

    <div class="content-window-grey">
        <div class="content-inner-box">
            <div class="content-text">
                <h3>Hledání v tisku</h3>
                <p>Jakmile máme vytvořen biblický dataset, můžeme se pustit do vyhledávání na libovolných datech, v našem případě na prvorepublikovém tisku. Každý dokument, který máme k dispozici, nejdříve rozdělíme na menší části. Experimentálně jsme došli k dělení dokumentů na části po šesti větách, vždy s překryvem alespoň jedné věty (pro případ, že by hledaný podverš obsahoval dvě věty a vyskytoval se na rozhraní částí prohledávaného dokumentu).</p>
                <p>Každá z těchto menších částí dokumentu je pak rozdělena na n-gramy a vektorizována za použití stejného slovníku, který vznikl v rámci tvorby biblického datasetu. Takto získaný vektor je následně porovnán s vektory jednotlivých podveršů. Pokud se n-gramy některého podverše ve sledované pasáži objevují alespoň ze 70 %, je předběžně zaznamenána shoda.</p>
            </div>
            <pre>
                <code class="language-python">
    """ Ukázka úryvku z tisku, který obsahuje biblický citát. """
    journal_passage = 'Věrnost církvi, věrnost vlasti, věrnost národa. Sám Kristus řekl určitě a jasné: Dávejte co jest císařovo císaři a co jest Božího Bohu. Jiný apoštolský výrok: Není mocnosti leč od Boha a které jsou, od Boha zřízeny jsou. Stát bez Boba byí by na chybném podkladu.'

    """ vektorizovaná část úryvku obsahující biblický citát """
    vectorized_passage = ((0, 2), (1, 2), (2, 1), (3, 1), (4, 1), (5, 1), (10, 1), (11, 1), (12, 1), (13, 1), (15, 2), (16, 2), (17, 1), (18, 1), (19, 1), (20, 1), (23, 1))

    """ porovnání podverše a úryvku: """
    subverse_text = 'Dávejte tedy co jest císařovo'
    subverse_vector = ((0, 1), (1, 1), (10, 1), (11, 1), (12, 1), (13, 1), (14, 1), (15, 1), (16, 1), (17, 1), (18, 1), (19, 1))

    overlap = ((0, 2), (1, 2), (10, 1), (11, 1), (12, 1), (13, 1), (15, 2), (16, 2), (17, 1), (18, 1), (19, 1))

    """ jediné slovo z podverše, které není detekováno, je "tedy" """
    unmatched = ((14, 1))

    """ Překryv je zde 91,66 %. """
    hit = 0.9166
                </code>
            </pre>
            <div class="content-text">
                <p>Následně je každý takto předběžně detekovaný podverš jednotlivě kontrolován, zda se v textu skutečně vyskytuje. Vzhledem k možné problematice OCR i omezenosti překladů Bible je nastavena určitá míra tolerance, která umožňuje, aby byla nalezena shoda, i pokud se verš nevyskytuje v úplně přesném znění. Pro tyto účely byla využita metoda tzv. <i>Levenštejnovy vzdálenosti</i>. Ve zkratce tato „vzdálenost“ značí, kolik znaků je třeba změnit, aby dva řetězce byly stejné. Experimentálně jsme dospěli k nastavení, že shodných by mělo být minimálně 85 % znaků z celkové délky podverše. Níže můžete vidět shodu jednotlivých podveršů na ukázkové pasáži.</p>
            </div>
            <pre>
                <code class="language-python" id="anchorLevenshtein">
    """ ukázka měření Levenštejnovy vzdálenosti """
    from Levenshtein import distance

    subverse_string = 'davejte tedy co jest cisarovo'
    query_string = 'davejte co jest cisarovo cisa'

    tolerance = len(subverse_string)*(1-0.85)

    if distance(subverse_string, query_string) <= tolerance:
    match = True
                </code>
            </pre>
            <div class="content-text">
                <p>V uvedeném případě se kvůli slovu „<i>tedy</i>“ o shodu nejedná. Jednak kvůli samotnému „<i>tedy</i>“, ale i proto, že jeho přítomnost prodloužila porovnávanou pasáž o řetězec „<i>cisa</i>“. Celkově je tedy třeba upravit 10 znaků, aby porovnávané řetězce byly stejné. Shoda je v tomto případě tedy pouhých 65,5 %. V případě porovnávaného verše se však v prohledávané pasáži plně objevují podverše „<i>co jest císařovo císaři</i>“ a „<i>císaři a co jest Božího</i>“.</p>
                <p>Na této ukázce je patrná i problematika dělení veršů na podverše. Toto rozdělení v mnoha případech nedává valný smysl, nicméně v praxi se ukazuje jako poměrně funkční. „Inteligentnější“ dělení veršů by vyžadovalo složitější přístup. Pro více informací o způsobu, jakým je dělení veršů prováděno, se můžete podívat na <a href="https://github.com/DigilabNLCR/BibleCitations/blob/main/biblical_intertextuality_notebook.ipynb">Jupyter Notebook</a> popisující proces prohledávání.</p>
            </div>
        </div>
    </div>

    <div class="content-window-white">
        <div class="content-inner-box">
            <div class="content-text">
                <h3 id="anchorCleaning">Čištění výsledků</h3>
                <p>Citáty nalezené za pomoci výše popsaného postupu jsou z principu nedokonalé. Nastavené tolerance, které umožňují nalézat citace i ve špatně rozpoznaném textu, vedou k mnoha falešně pozitivním výsledkům. Navíc bylo detekováno mnoho veršů a podveršů, které sice svým textem odpovídají, ale o skutečné biblické citáty se nejedná. Předběžné výsledky je tedy nutné ještě vyčistit. Celý proces čištění výsledků, který obsahuje i předběžné vyhodnocení celkové shody, je možné prozkoumat v <a href="https://github.com/DigilabNLCR/BibleCitations/blob/main/evaluation.ipynb">Jupyter Notebooku</a> popisujícím evaluaci. Kromě filtrace duplicitních výsledků jsou nejdůležitější následující dva kroky:</p>
                <ol type="1">
                    <li>Filtrace osamocených „stop-podveršů“. Z detekovaných výsledků jsou vytipovány ty podverše, které samy o sobě nemají žádnou jasnou biblickou relevanci. Může se jednat například o citáty zemědělské/pastevecké povahy, např. Nu 32:4 „<i>máme velmi mnoho dobytka</i>“, o zmínky o právu a spravedlnosti, např. Žd 11:33 „<i>vykonali spravedlnost</i>“, či o další verše všeobecné povahy. Při výběru je nicméně dobré pamatovat na to, že některé verše, které vypadají obyčejně, mohou jako být ve skutečnosti biblickými citáty, a tedy při této filtraci samozřejmě dochází ke ztrátám. Mezi stop-podverše však mohou být zařazeny i ty podverše, které sice mají jasnou biblickou konotaci, samy o sobě však nejsou biblickým citátem, nýbrž běžným slovním spojením v rámci křesťanského prostředí - např. „<i>a Pána Ježíše Krista</i>“. Celkem bylo vytipováno 2692 <a href="https://github.com/DigilabNLCR/BibleCitations/blob/main/evaluation_stop_subverses_21.txt">stop-podveršů</a><br>Kromě samotných stop-podveršů bylo také vytipováno několik veršů, u kterých je vyžadována 100 % shoda, aby byly uznány za výsledek. Tolerance překlepů u veršů typu „<i>Nezabiješ</i>“ vede k přílišnému množství falešně pozitivních výsledků.</li>
                    <li>Vypořádání se s vícečetnými atribucemi. Jak bylo zmíněno <a href="#anchorBibleProblems">výše</a>, některé verše se navzájem duplikují či jsou si svým obsahem velice podobné. Všeobecně je citace připsána tomu verši, který má lepší shodu. V případech, kdy je shoda stejná, je citace označena za duplicitní, ale ponechána je více veršům.</li>
                </ol>
                <p>Výsledky, které jsou takto vyfiltrované, mohou být dále podrobeny ruční kontrole, případně dalším filtrům. Je například možné vybrat pouze ty citáty, které obsahují celý verš a u kterých je tedy vysoce pravděpodobné, že jsou skutečnými citáty (na grafu níže <i>"sure" citations</i> zastoupené fialovou barvou). Tím sice podstatně redukujeme počet falešně pozitivních citací, ale samozřejmě mnohé méně jasné citace ztrácíme.</p>
                <p id="resultsClearing">Na následujícím grafu můžete vidět vývoj celkového počtu citací v letech po jednotlivých krocích čištění. Data, která jsou prezentována v grafech napříč tímto projektem, vycházejí z <i>filtered multiple attributions</i> znázorněných oranžovou barvou. Tyto výsledky mohou stále obsahovat určité množství <i>falešně pozitivních</i> výsledků, nicméně zároveň z výsledků neeliminují zbytečné množství těch <i>falešně negativních</i>.</p>
                <p>Kompletní výsledky naleznete <a href="https://github.com/DigilabNLCR/BibleCitations/tree/main/PUBLIC_RESULTS">zde</a>, zejména pak v <a href="https://github.com/DigilabNLCR/BibleCitations/blob/main/PUBLIC_RESULTS/MUTUAL_DROP_SURE_MA_DUPS_ST_SUBS_FILTERED_UNFILTERED_batch_results.csv">tomto CSV souboru</a>.</p>
            </div>
            <div class="flourish-embed flourish-chart" data-src="visualisation/11096881"><script src="https://public.flourish.studio/resources/embed.js"></script></div>
        </div>
    </div>

    <div class="content-window-grey">
        <div class="content-inner-box">
            <div class="content-text">
                <h2>Limity</h2>
                <p>Celý postup je navržen tak, aby badatelé mohli nastavit různé míry tolerance dle vlastního uvážení a šité na míru prohledávanému korpusu. Zde navržené řešení je zatím značně nedokonalé a může sloužit pouze jako předvýběr pasáží, na které se badatel může následně detailně zaměřit. Statistické výstupy je třeba brát pouze jako orientační.</p>
                <h3 id="anchorImprovements">Možná zlepšení</h3>
                <p>Vzhledem k nedokonalosti navrženého řešení je samozřejmě možné dále pracovat na jeho vylepšování. První oblast vývoje může být zaměřena na rychlost procesu. <a href="#anchorRuntimes">Níže</a> můžete vidět přehled o času, který je k vyhledávání potřeba. V průběhu vytváření workflow již došlo ke značnému zlepšení, které ovlivnily například následující faktory:</p>
                <ul>
                    <li>nalezení ideálního nastavení funkcí, které reflektuje povahu datasetů</li>
                    <li>volba příhodných balíčků Python (např. volba <a href="https://pypi.org/project/python-Levenshtein/">Levenshtein.distance</a> oproti <a href="https://www.nltk.org/api/nltk.metrics.distance.html?highlight=edit_distance">nltk.metrics.distance.edit_distance</a>), či vektorizace za pomoci balíčku <a href="https://radimrehurek.com/gensim/">gensim</a></li>
                    <li>vyhnutí se tzv. <i>dot operations</i> u importování funkcí z externích balíčků (viz <a href="#anchorPythonPackages">výše</a>).</li>
                </ul>
                <p>Zrychlení je ale možné dosáhnout i dalšími způsoby – ať už vylepšením samotného scriptu, jeho transformací do jiného programovacího jazyka (doporučen byl např. <a href="https://www.rust-lang.org/">Rust</a>), či použitím výpočetně silnějších strojů.</p>
                <p>Důležitější část vývoje by se však měla zaměřit na zlepšování přesnosti vyhledávání. Jednou z možných cest by bylo využití metod strojového učení (ML), které však předpokládá, že je k dispozici již čistý dataset, na jehož základě lze trénovat. Zde navržené řešení tak může poskytnout předběžná data, která po vyčištění mohou být použita jako vstup pro ML řešení.</p>
                <p>Jednodušší metodu může představovat detekce výskytu klíčových slov v okolí nalezené citace. Pokud by se v blízkosti vyskytovala např. slova jako „<i>Ježíš</i>“, „<i>Bible</i>“ a podobně, zásadně to zvyšuje šanci, že se jedná o biblický citát. Tento přístup má však samozřejmě pouze omezenou výpovědní hodnotu a je také omezen současným stavem OCR prohledávaných dokumentů, viz <a href="#anchorJournalsProblems">výše</a>.</p>
                <p>Další cestou tedy může být snaha o vylepšení prohledávaného datasetu, v našem případě prvorepublikového tisku. Na prohledávaný dataset je možné aplikovat novější a přesnější OCR programy nebo je možné pokusit se stávající stav vylepšit za pomoci korektorů, např. <a href="http://lindat.mff.cuni.cz/services/korektor/">LINDAT Korektor</a>.</p>
            </div>
        </div>
    </div>

    <div class="content-window-white">
        <div class="content-inner-box">
            <div class="content-text">
                <h2 id="anchorRuntimes">Časová náročnost</h2>
            </div>
            <div class="flourish-embed flourish-chart" data-src="visualisation/11096231"><script src="https://public.flourish.studio/resources/embed.js"></script></div>
            <div class="content-text">
                <p>Tento graf zobrazuje průměrné časy (v sekundách), které byly potřeba ke zpracování jednotlivých stránek (stránkování dle periodik, nikoliv normostran). Výsledky reflektují zejména celkovou délku analyzovaných stránek (např. periodikum <i>Venkov</i> má nejdelší časy analýzy zejména proto, že má nejdelší stránky), ale projevuje se zde také počet předběžně vytipovaných citací – čas zpracování zásadně narůstá zejména při ověřování <i>Levenštejnovy vzdálenosti</i> (viz <a href="#anchorLevenshtein">výše</a>). V průběhu vytváření scriptu docházelo k postupnému vylepšování potřebných časů (zde vyobrazené časy se vztahují k poslední verzi zveřejněné na portálu <a href="https://github.com/DigilabNLCR/BibleCitations">GitHub</a>). Celkový čas prohledávání v poslední verzi byl přibližně 220 a půl hodiny.</p>
                <p>Další čas byl samozřejmě potřebný pro následné čištění dat, kde bylo nejvíce času věnováno (ručnímu) výběru stop-podveršů.</p>
            </div>
        </div>
    </div>